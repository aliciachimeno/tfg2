\documentclass[../main.tex]{subfiles}
\begin{document}
	\chapter{Lemmas and proof} \label{ch:proof}
	\noindent  This chapter presents the lemmas that are necessary to prove the main theorem. The problem of approximating a function g on some compact $K$ of $\mathbb{R}^n$ from $\Sigma_n$, can be divided into two parts. One part is the approximation of the form $\sum_i f_i(a^i \cdot x)$ where $f_i$ are functions in $C(\mathbb{R})$. The other is the approximation of $f_i$ on the appropiate set from $\Sigma_1$. \textcolor{red}{!!canviar}
	\section{$\sigma \ast \varphi$ is not a polynomial.}
	\begin{lema}  % L1 :step 6
		If we have that $\sigma \ast \varphi $ is a polynomial for all $\varphi \in \mathcal{C}^\infty_0 $.  Then the degree of the polynomial $\sigma \ast \varphi $ is finite, i.e. there exists an m $\in \mathbb{N}$ such that $ deg (\sigma \ast \varphi) \leq m$ for all $\varphi \in \mathcal{C}^\infty_0$. 
	\end{lema}
	\begin{proof}
		We first prove the claim in the case of $\varphi \in \mathcal{C}^\infty_0[a,b]$, where $\mathcal{C}^\infty_0[a,b]$ is the set of functions $\mathcal{C}^\infty_0$ with support in $[a,b]$ for any $a<b$. \\ \\ Let $\rho$ be a metric on $\mathcal{C}^\infty_0[a,b]$ defined by
		$$\rho(\varphi_1,\varphi_2) = \sum_{n=0}^\infty 2^{-n}  \frac{\|\varphi_1 -\varphi_2\|_n}{1+\|\varphi_1 -\varphi_2\|_n}$$ where $\|\varphi\|_n= \sum_{j=0}^n \sup_{x\in [a,b]} | \varphi^{(j)}(x)| $. We can show that $(\mathcal{C}^\infty_0[a,b],\rho)$  is a complete metric space (Fréchet space). By assumption, we have that $\sigma \ast \varphi$ is a polynomial (for any $\varphi \in \mathcal{C}^\infty_0[a,b]$). \\ \\  Consider the following set, which has the property that we want to show.  \\ $$V_k= \{\varphi \in \mathcal{C}_0^\infty[a,b] \, | \,  deg(\sigma \ast \varphi ) \leq k\}$$ Clearly, if $\varphi \in V_k$, then $deg(\sigma \ast \varphi) \leq k.$ We want to show that $\mathcal{C}_0^\infty[a,b] \subseteq V_k.$ This set fulfills the following properties, $V_k \subset V_{k+1}$, $V_k $ is a closed subspace and $\cup_{k=0}^\infty V_k = \mathcal{C}_0^\infty[a,b]$. As $\mathcal{C}_0^\infty[a,b]$ is a complete metric space, for Blaire's Category Theorem then there exists an integer $m$ such that $V_m=\mathcal{C}_0^\infty[a,b]$. \\ \\ 
		For the general case where $\varphi \in \mathcal{C}_0^\infty$, we note that the number $m$ does not deppend on the interval $[a,b]$.   \textcolor{red}{!! acabar}

	\end{proof}
	\begin{lema} % L2: step 7
		If $\sigma \ast \varphi$ is a polynomial such that $ deg (\sigma \ast \varphi) \leq m$ for all $\varphi \in \mathcal{C}^\infty_0$, then $\sigma$ is a polynomial of degree at most $m$.
	\end{lema}
	\begin{proof} 
	If $\sigma \ast \varphi$ is a polynomial of degree $m$.
	For all $\varphi \in \mathcal{C}^\infty_0$, we have that
	$$(\sigma \ast \varphi)^{(m+1)} \, (x)=\int \sigma(x-y)\varphi^{(m+1)}(y) \, dy= 0$$  
	From standard results in Distribution Theory, $\sigma $ is itself a polynomial of degree at most m (a.e.).  \textcolor{red}{!!ho he buscat i no he trobat res perquè implica que sigma polinomi que la integral sigui 0}
	\end{proof} 
\noindent Conclusion: If we have that $\sigma \ast \varphi$ is a polynomial then $\sigma$ is a polynomial. This contradicts the hypothesis. Therefore, $\sigma \ast \varphi$ will not be a polynomial. 


\section{$\sigma \ast \varphi \in \overline{\Sigma_1}$}
	\begin{lema} % L3: step 4
		For each $\varphi \in  \mathcal{C}^\infty_0$, $ \sigma \ast \varphi \in  \overline{\Sigma_1}$. 
		
	\end{lema}
	
	\begin{proof} % proof step 4
		We recall that set 
		\begin{equation}
			\Sigma_1 = \text{span} \{ {\sigma(w\cdot x + \theta) : w\in \mathbb{R}, \theta \in \mathbb{R} \} } 
			\tag{1}
			%\label{eq:ecuacion1}
		\end{equation}
		Consider $$h_m= \sum_{i=1}^m\varphi(y_i)\Delta y_i \sigma(x-y_i)$$ 
		The sequence $(h_m)$ satisfies $h_j\in \Sigma_1$ for $j=1,...,m$. ($w_i=1,\theta_i=-y_i, \beta_i=\varphi(y_i)\Delta y_i$).\\ \\ 
		Where $y_i=-\alpha + \frac{2i\alpha}{m}$, $\Delta y_i=\frac{2\alpha}{m}$ for $i=1,...,m$. Partition of the interval $[-\alpha,\alpha]$ \\ \\ We want to show that $h_m \rightrightarrows \sigma \ast \varphi $ in $[-\alpha,\alpha]$.  \\ \\
		Given $\epsilon >0$, we choose $\delta >0$ such that $10\delta \| \sigma\|_{L^\infty\{-2\alpha,2\alpha\}}\|\varphi \|_{L^\infty} \leq \frac{\epsilon}{3}$. Note that ... \\ \\ 
		We know that $\sigma \in M$. Hence, for this given $\delta>0$ and $[-\alpha,\alpha]$ interval, there exists $r(\delta)$ finite number of intervals the measure of whose union $\mathscr{U}$ is $\delta$ such that $\sigma$ is uniformly continuous on $[-2\alpha,2\alpha]$. We now choose $m_i$ sufficiently large so that
		\begin{enumerate}
			\item $m_1 \delta > \alpha r(\delta)$. We can do this by Archimedes' principle.
			\item From the uniform continuity of $\varphi$.
			\item From the previous, $\sigma$ is uniformly continuous on  $[-2\alpha,2\alpha]$. 
		\end{enumerate}
		We choose $m$ such that $m=max\{m_1,m_2,m_3\}$. \\ \\ 
		Now, fix $x\in [-\alpha,\alpha] $. Set $\Delta_i= [y_{i-1},y_i]$ where $y_0= \alpha$ .. dibuix. \\ \\
		First, recall that,\\
		$$\int \sigma(x-y)\varphi(y)dy = \sum_{i=1}^m \int_{\Delta_i}\sigma(x-y)\varphi(y)dy$$
		Consider the following difference 

\begin{equation*} 
	\begin{split}
		\Bigg| \int \sigma(x-y)\varphi(y)dy -  \sum_{i=1}^m \int_{\Delta_i} \sigma(x-y_i)& \varphi(y)dy \Bigg| =  \\
		& = \left|  \sum_{i=1}^m \int_{\Delta_i}\sigma(x-y)\varphi(y)dy -  \sum_{i=1}^m \int_{\Delta_i}\sigma(x-y_i)\varphi(y)dy \right|  \\
		& =  \left|  \sum_{i=1}^m \int_{\Delta_i}\varphi(y)\Big( \sigma(x-y) - \sigma(x-y_i)\Big)dy \right| \\
		&\leq  \sum_{i=1}^m \int_{\Delta_i} \left| \varphi(y)\right| \left| \sigma(x-y)-\sigma(x-y_i)\right|dy 
	\end{split}
\end{equation*}
		If $x-\Delta_i \cap U = \varnothing $. Since $x-y \notin U$ , $x-y_i \notin U$ and $x-y_i \in [-2\alpha,2\alpha]$, bc (2) we have
		\begin{equation*}
			\begin{split}
				\sum_{i=1}^m  \int_{\Delta_i} \left| \varphi(y)\right| \left| \sigma(x-y)-\sigma(x-y_i)\right|dy  \leq  \frac{\epsilon}{\| \varphi\|_{L_1}}  \sum_{i=1}^m  \int_{\Delta_i} \left| \varphi(y)\right| = & \\
				& =  \frac{\epsilon}{3\| \varphi\|_{L_1}} \int \left|\varphi(y)\right| dy \\
				& =  \frac{\epsilon}{3\| \varphi\|_{L_1}} \left|\varphi(y)\right|_{L_1} = \frac{\epsilon}{3} 
			\end{split}
		\end{equation*}
		
		\noindent If $x-\Delta_i \cap U \neq \varnothing$\\ \\ 
		$\sum_i |\tilde{\Delta_i}| = \sum_i|(x-\Delta_i \cap U)| \leq |U|+2|\Delta_i| r(\delta) \leq \delta + 2 \cdot \frac{2\alpha}{m} r(\delta) \leq \delta +4\delta = 5\delta$  \\ \\ 
		True by our choice of m, satisfies $m\delta > \alpha r(\delta) \iff \delta > \frac{\alpha \cdot r(\delta)}{m}$
		
		
		\begin{equation*}
			\begin{split}
				\sum_{i=1}^m  \int_{\tilde{\Delta_i}} \left| \varphi(y)\right| \left| \sigma(x-y)-\sigma(x-y_i)\right|dy & \leq \\
				&  \leq  \sum_{i=1}^m  \int_{\tilde{\Delta_i}} \| \varphi\|_{L^{\infty}} \, 2 \| \sigma \|_{L^{\infty}[-2\alpha,2\alpha]} \\
				& = \| \varphi\|_{L^{\infty}} \, 2 \| \sigma \|_{L^{\infty}[-2\alpha,2\alpha]} \sum_i| \tilde{\Delta_i} | \\
				& \leq \| \varphi\|_{L^{\infty}} \, 2 \| \sigma \|_{L^{\infty}[-2\alpha,2\alpha]} \, 5 \delta \leq \epsilon /3
			\end{split}
		\end{equation*}

\begin{equation*} 
	\begin{split}
		\Bigg| \sum_{i=1}^m \int_{\Delta_i} \sigma(x-y_i)\varphi(y)dy -  \sum_{i=1}^m \sigma(x-y_i)& \varphi(y_i)\Delta y_i \Bigg| =  \\
		& =  \left|  \sum_{i=1}^m \int_{\Delta_i} \sigma(x-y_i) [\varphi(y)-\varphi(y_i)] dy \right| \\
		& \leq  \sum_{i=1}^m \int_{\Delta_i}  \left| \sigma(x-y_i)\right| \left| \varphi(y) - \varphi(y_i)\right|dy  \\
		& \leq  \sum_{i=1}^m \int_{\Delta_i}  \left| \sigma(x-y_i)\right| dy \left[ \frac{\epsilon/3}{2\alpha \| \sigma\|_{L^\infty[-2\alpha,2\alpha]}}\right]  \leq \frac{\epsilon}{3} 
	\end{split}
\end{equation*}
Finally, we have the result $h_m \rightrightarrows \sigma \ast \varphi $ because

$$\Bigg| \int \sigma(x-y)\varphi(y)dy -  \sum_{i=1}^m \sigma(x-y_i) \varphi(y_i) \Delta y_i \Bigg| \leq \epsilon $$
for all $x\in [-\alpha,\alpha ]$
	\end{proof}
	
	\section{$\Sigma_1$ dense in $\mathcal{C}(\mathbb{R})$}
	\begin{lema} % L4: step 3
		If $\sigma \in \mathcal{C}^{\infty}$, then $ \Sigma_1$ is dense in  $\mathcal{C}(\mathbb{R})$.
	\end{lema}
	
	\begin{proof} % proof step 3
		Recall the set $\Sigma_1 $ with $(1)$. We can write any function $h\in \Sigma_1$ as $$h=\sum_i \beta_i \sigma_i(w_i x+\theta_i)= \beta_1 \sigma_1(w_1 x+\theta_1)+ ... $$ 
		We can see that $$\frac{\sigma([w+h]x + \theta) - \sigma(wx+\theta)}{h} \in \Sigma_1$$ because is a linear combination, where $\beta_1= \frac{1}{h}, \beta_2=\frac{-1}{h}$. \\ \\  By hypothesis, $\sigma \in \mathcal{C}^{\infty}$. By definition of derivative we have
		$$ \frac{d}{dw}\sigma(wx+\theta)= \lim_{h \to 0} \frac{\sigma([w+h]x + \theta) - \sigma(wx+\theta)}{h}  \in \overline{\Sigma_1} \footnote{$\overline{\Sigma_1}$ denotes the clausure of the set $\Sigma_1$} $$
		because the limit of a set belongs to the closure of the set. \\  \\ 
		By the same argument, $$\frac{d^k}{dw^k} \sigma(wx+\theta) \in \overline{\Sigma_1}$$  for all $k\in \mathbb{N}, w,\theta \in \mathbb{R}$.\\ \\ 
		 If we differentiate this expression k times, we obtain 
		$$ \frac{d^k}{dw^k}\sigma(wx+\theta) = \sigma^{(k)}(wx+\theta) \cdot x^{k}$$
		We will see by reduction to absurdity that if $\sigma$ is not a polynomial (by hypothesis) then there exists a $\theta_k\in \mathbb{R}$ such that $\sigma^{(k)}(\theta_k)  \neq 0$. \\ If $\sigma$ is not a polynomial and $\sigma \in \mathcal{C}^\infty$, lets assume that $ \nexists \theta_k \in \mathbb{R}$ such that $\sigma^{(k)}(\theta_k)  \neq 0$. This means that the k-th derivative at every point is 0, $$\sigma^{(k)}(\theta)=0  \quad \forall \theta \in \mathbb{R} $$
		\noindent If we integrate k times this expression, $$\int \sigma^{(k)}= \int 0 \Rightarrow \sigma^{(k-1)}=C$$, $$\int \sigma^{(k-1)}= \int C \Rightarrow \sigma^{(k-2)}=Cw$$, then we end up $\sigma$ is a polynomial. Contradiction. Therefore, there always exists a point where the derivative does not vanish. \\ 
		Thus, we evaluate at the point where the derivative does not vanish, we call it $\theta_k$.
		$$  \sigma^{(k)}(\theta_k) \cdot x^{k}=\frac{d^k}{dw^k}\sigma(wx+\theta) \Bigr|_{w=0, \theta=\theta_k} \in  \overline{\Sigma_1} $$ 
		This implies that $\overline{\Sigma_1}$ contains all polynomials, because the expression $\sigma^{(k)}(\theta_k) x^{k}$ generates all polynomials. By the Weierstrass theorem, we know that the polynomials are dense in $\mathcal{C}(\mathbb{R})$. This concludes that the set $\overline{\Sigma_1}$ contains a set which is dense in  $\mathcal{C}(\mathbb{R})$, therefore $\Sigma_1$ is dense in $\mathcal{C}(\mathbb{R})$.
		
		
	\end{proof}
	
	\begin{lema} % L5: step 5
		If for some $\varphi \in \mathcal{C}^\infty_0 $ we have that $\sigma \ast \varphi $ is not a polynomial, then $\Sigma_1$ is dense in $\mathcal{C}(\mathbb{R})$.
	\end{lema}
	 \begin{proof}
	 From Lemma 3, $\sigma \ast \varphi \in  \overline{\Sigma_1}$. Clearly, $\sigma \ast \varphi (wx+\theta ) \in  \overline{\Sigma_1}$, for each $\theta \in \mathbb{R}$. For $\sigma$ and $\varphi \in \mathcal{C}^\infty_0$ we have that $\sigma \ast \varphi \in  \mathcal{C}^\infty $. (ho hem de veure!!!). From Lemma 4, if $\sigma \ast \varphi \in  \mathcal{C}^\infty $, then $\Sigma_1$ dense in $\mathcal{C} (\mathbb{R}^n)$. ???? (nose si apliquem el lemma 4 amb sigma = sigma conv varphi o si sigma conv varphi de c infinit implica sigma de c infinlt aleshores apliquem el lemma 4 ??)
	 \end{proof}
 \section{{$\Sigma_1$ is dense in $\mathcal{C}(\mathbb{R})$, then $\Sigma_n$ is dense in $\mathcal{C}(\mathbb{R}^n)$ }}
 
 \noindent We will proof that approximating a $\mathcal{C}(\mathbb{R})$ function  with one from the set $\Sigma_1$ implies approximating a function $\mathcal{C}(\mathbb{R}^n)$ from the set $\Sigma_n$. Therefore, it is only necessary to approximate a continuous function. We can see this from the density characterization:

	\begin{lema}  % L6: step 2
			If $\Sigma_1$ is dense in $\mathcal{C}(\mathbb{R})$, then $\Sigma_n$ is dense in $\mathcal{C}(\mathbb{R}^n)$. 
		\end{lema}
	
	\begin{proof} % proof  step 2
			Let $$V:= span\{ f(ax) : a \in \mathbb{R}^n, f \in \mathcal{C}(\mathbb{R}) \}$$ We shall see that $V$ is dense in $\mathcal{C}(\mathbb{R}^n)$.  If we show that $V$ contains the polynomials ( which are dense in $C(R^n)$ for Weierstrass Theorem) that would be enough. \\ \\  
			\textcolor{red}{!!mirar}
			Let $L(a)$ denote the span of the n rows of $a$ for each $a\in \mathbb{R}^n$. Set $L(R^n) = \cup L(a)$. Let $$H_k^n= \{ \sum c_m s^m \}$$  denote the set of homogeneous polynomials of n variables of total degree k, and $$H^n= \cup_{k=0}^\infty H_k^n$$ the set of all homogeneous polynomials of n variables. \\  \\ 
			Assume that for a given $k\in \mathbb{N}$ no non-trivial $p\in H_k^n \subseteq V$ for all $k\in \mathbb{Z}$, then V contains all polynomials. For that we have V dense in $\mathcal{C}(\mathbb{R}^n)$. Now, we only need to show that $H_k^n \subseteq  V$. SOS
			\\ \\
			Let $g\in \mathcal{C}(\mathbb{R}) $, for any compact subset $K \subset \mathbb{R}^n  $, $V$ dense in $\mathcal{C}(K)$. That is, given $\epsilon >0$, there exist $f_i\in  \mathcal{C}(\mathbb{R})$ and $a_i \in \mathbb{R}^n $    {\scriptsize $i=1,...,k$}  such that
			
			$$ \big| g(x)-\sum_{i=1}^k f_i(a^i \cdot x) \big| < \frac{\epsilon}{2}$$
			for all $x\in K$. We now consider the set of all the points in the compact $K$ multiplied by the vector $a^i$. That is $\{a^i \cdot x | x \in K\}$ $\subseteq[\alpha_i,\beta_i] $ for some finite interval $[\alpha_i,\beta_i]$, $i=1,...,k$. By hipothesis $\Sigma_1 $ dense in $\mathcal{C}(\mathbb{R})$ , specifically $\Sigma_1 $ is dense in $[\alpha_i,\beta_i ]$ $ \, i=1,...,k$. Hence there exist constants $c_{ij}, w_{ij}$ and $\theta_{ij}$, $j=1,...,m_i$, $i=1,...,k$ such that 
			
			$$ \big| f_i(y) - \sum_{j=1}^{m} c_{ij} \sigma(w_{ij}y+ \theta_{ij})\big| < \frac{\epsilon}{2k}$$
			for all $x\in K$. \\ \\
			Therefore, 
			$$ \big| g(x) - \sum_{i=1}^k \sum_{j=1}^m c_{ij} \sigma(w_{ij}(a^i \cdot x) + \theta_{ij})  \big| < \epsilon$$
		\end{proof}
	We showed that to approximate a $\mathcal{C}(\mathbb{R}^n)$ function we only need to approximate a $\mathcal{C} (\mathbb{R})$ function with the set $\Sigma_1$. 

\section{Proof of the theorem}
	\begin{proof}~ % proof del teorema

	\begin{enumerate}
		\item[$\Rightarrow$] To prove the implication, we will use proof by contrapositive. We will see the following. If $\sigma$ is a polynomial then $\Sigma_n$ is not dense in $\mathcal{C}(\mathbb{R}^n)$. Let $\sigma$ be a polynomial of degree k, then $\sigma(wx+\theta)$ is a polynomial  of degree k for every $w,\theta$. We have $ \Sigma_n = span\{\sigma(w\cdot x + \theta) : w\in \mathbb{R}^n, \theta \in \mathbb{R} \}$ that is the set of algebraic polynomials of degree at most k. $\Sigma_n$ is not dens in $\mathcal{C}(\mathbb{R}^n)$ if for a function $f(x)\in \mathcal{C}(\mathbb{R}^n)$ we can find $\epsilon > 0$ and $K$ such that  $\| p-f \| > \epsilon$ for all $p$ polynomial of degree k. For example, let $f(x)=cos(x)$, and let $p(x)= \sigma(wx+\theta)$ that has degree at most k. This implies has maximum k roots. We can find a interval where $cos(x)$ has k+1 roots. Therefore, $\Sigma_n$ is not dense in $\mathcal{C}(\mathbb{R}^n)$. 

		\item[$\Leftarrow$]  Recapitulem el que hem vist als lemes ..
	\end{enumerate}
\end{proof}
	\cite{leshno1993multilayer}
\end{document}